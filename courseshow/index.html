<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content=" user-scalable=yes">
	<title>网易教育产品部By onlyoneday</title>
	<link rel="stylesheet" href="style.css"></head>
</head>
<body>
	<!-- 顶端cookie -->
	<div class='advertise'>
		<span class='content'>网易云课堂微专业，帮助你掌握专业技能，令你求职或加薪多一份独特优势！</span>
		<a>立即查看></a>
		<span class='control'>X 不再提醒</span>
	</div>

	<!-- 导航 -->
	<div class='container header-pannel'>
		<div class="m-header">
			<div class='left'>
				<span class='logo'>EDU </span>
				<span class='name'>网易教育产品部</span>
				<span class='follow'>+ 关注</span>
				<div class="followed">
					<div class="follow-left">√已关注</div>
					<span style="margin:0 5px;color:#cbcbcb;">|</span>
					<div class="follow-right">取消</div>
				</div>
				<span class='fans'>粉丝</span>
				<span class='fans-num'>45</span>
			</div>
			<div class='right'>
				<a class='f1' href='http://open.163.com/'>网易公开课</a>
				<a class='f2' href='http://study.163.com/'>云课堂</a>
				<a class='f3' href='http://www.icourse163.org/'>中国大学MOOC</a>
				<div class="search"></div>
			</div>
		</div>
		
	</div>

	<!-- 轮播 -->
	<div class="slider-container">
		<div class='slider-indicator'>
			<i class='slider-indicator-btn slider-indicator-btn-active'></i>
			<i class='slider-indicator-btn'></i>
			<i class='slider-indicator-btn'></i>
		</div>
	</div>

	<!-- 产品 -->
	<div class="container product-container">
		<div class='product'>
			<div class='product-item'>
				<div class='logo'>
					<img src="img/kecheng1.png">
				</div>
				<div class='content'>
					<div class='title'>网易公开课</div>
					<div class='describe'>推出国内外名校公开课，涉及广泛的学科，名校老师认真讲解深度剖析，网易视频公开课频道搭建起强有力的网络视频教学平台。</div>
					<div class='more'>了解更多></div>
				</div>			
			</div>
			<div class='product-item'>
				<div class='logo'>
					<img src="img/kecheng2.png">
				</div>
				<div class='content'>
					<div class='title'>云课堂</div>
					<div class='describe'>网易旗下大型在线学习平台，该平台面向学习者提供海量免费、优质课程,创新的个性化学习体验，自由开放的交流互动环境。</div>
					<div class='more'>了解更多></div>
				</div>	
			</div>
			<div class='product-item'>
				<div class='logo'>
					<img src="img/kecheng3.png">
				</div>
				<div class='content'>
					<div class='title'>中国大学MOOC</div>
					<div class='describe'>是爱课程网携手云课堂打造的在线学习平台，每一个有提升愿望的人,都可以在这里学习中国最好的大学课程，学完还能获得认证证书。</div>
					<div class='more'>了解更多></div>
				</div>	
			</div>
		</div>
	</div>

	<!-- 工作环境 -->
	<div class="container work-env-pannel">
		<div class="work-env">
			<img src="img/work1.png" alt="">
			<img src="img/work2.png" alt="">
			<img src="img/work3.png" alt="">
			<img src="img/work4.png" alt="">
			<img src="img/work5.png" alt="">
		</div>		
	</div>

	<!-- 课程列表 -->
	<div class="container course-container">
		<div class="m-course">
			<div id="course" class="left">
				<div class="tab">
					<div class="tab-item tab-item-active">产品设计</div>
					<div class="tab-item">编程语言</div>
				</div>
				<div class="course-panel"></div>
				<div class="page-nav">
					<div class="course-prev"><</div>
					<span class="num-pannel"></span>					
					<div class="course-next">></div>
				</div>
			</div>
			<div class="right">
				<div class="intro">
					<div class="title">机构介绍</div>
					<div class="content">
						<p class="desc">观看下面的视频来了解吧：</p>
						<div class="video-snap">
							<img class="video-img"src="img/video1.png">
							<img class="video-img-hover" src="img/video2.png">
						</div>						
					</div>
				</div>
				<div class="hot-rank">
					<div class="title">最热排行</div>
					<div class="hot-pannel">
						<div class="hot-content"></div>
					</div>
					
				</div>
			</div>
		</div>
	</div>

	<!-- 底部 -->
	<div class="container m-footer">
		<div class="contact">
			<div class="title">
				<span class='logo'>EDU</span>
				<span class='name'>网易教育产品部</span>
			</div>			
			<div class='contact-txt'>©2014 icourse163.org 浙ICP备08114786号-1</div>
			<div class="contact-txt">icourses.cn 京ICP备12020869号-2 京公网安备110102000459-2</div>
		</div>
		<div class="link">
			<p>友情链接：</p>
			<p>网易公开课</p>
			<p>网易云课堂</p>
			<p>中国大学MOOC</p>
		</div>
		<div class="about">
			<div>我们：</div>
			<div>关于</div>
			<div>联系</div>
			<div>关注 <img src="img/weibo.png"></div>
		</div>
		<div class="more">
			<p>更多：</p>
			<p>常见问题</p>
			<p>意见反馈</p>
		</div>
	</div>




	<!-- 登录 -->
	<div class="login-mask-pannel">
		<div class="login-pannel">
			<div class="login-close-bar">
				<img class='login-close-control' src="img/video-x.png">
			</div>
			<div class="login-content">
				<p class="title">登陆网易云课堂</p>	
				<input class="login-account" type="text" name="fname" placeholder="帐号"><br>
				<input class="login-password" type="password" name="fname" placeholder="密码"><br>
				<input class="login-button" type="button" value="登录">
			</div>
		</div>
	</div>

	<!-- 视频video -->
	<div class="video-mask-pannel">
		<div class="video-pannel">
			<div class="close-bar">
				<img class='video-close-control' src="img/video-x.png">
			</div>
			<p>请观看下面的视频</p>
			<video controls autoplay>
			 	<source src="http://mov.bn.netease.com/open-movie/nos/mp4/2014/12/30/SADQ86F5S_shd.mp4" type="video/mp4">
			 	您的浏览器不支持 video 标签。
			</video>
		</div>
	</div>




<script src='js/util.js'></script>
<script src='js/slider.js'></script>
<script src='js/ajax.js'></script>
<script src='js/md5.js'></script>
<script>
window.onload = function(){


//获取元素
function E(class_name) {
	return document.getElementsByClassName(class_name)[0];
}

/**********************Cookie相关 START*****************************/

function getcookie() {
	var cookie = {};
	var all = document.cookie;
	if (all === '') return cookie;
	var list = all.split('; ');
	for (var i = 0, len = list.length; i < len; i++) {
		var item = list[i];
		var p = item.indexOf('=');
		var name = item.substring(0, p);
		name = decodeURIComponent(name);
		var value = item.substring(p + 1);
		value = decodeURIComponent(value);
		cookie[name] = value;
	}
	return cookie;
}

function setcookie(cookie){
	var str = '';
	var first_flag = true;
	for (var key in cookie) {
		if (first_flag) {
			str +=  encodeURIComponent(key) + '=' + encodeURIComponent(cookie[key]);
			first_flag = false;
			continue;	
		}
		str += '; ' + encodeURIComponent(key) + '=' + encodeURIComponent(cookie[key]);
	}
	console.log(str);
	document.cookie = str;
}

var advertise = E('advertise');
var cookie = getcookie();
if (!(!cookie['advertise'] || cookie['advertise'] == 'true')) {
	advertise.style.display = "none";
} 

util.addEvent(E('control'), 'click', function() {
	advertise.style.display = 'none';
	setcookie({'advertise': 'false'});
});


/**********************Cookie相关 END*****************************/

/**********************关注登录相关 START*****************************/

if (cookie['followSuc'] && cookie['followSuc'] == 'true') {
	E('follow').style.display = "none";
	E('followed').style.display = "block";
}

util.addEvent(E('follow'), 'click', function(){
	var cookie = getcookie();
	// have logined
	if (cookie['loginSuc'] && cookie['loginSuc'] == 'true') {
		ajax.get('http://study.163.com/webDev/attention.htm',function(data){
			if (data == '1') {
				setcookie({'followSuc': 'true'});
				E('follow').style.display = "none";
				E('followed').style.display = "block";
			}
		});
		return;
	}
	// not login
	E('login-mask-pannel').style.display = 'block';
});

util.addEvent(E('login-button'),'click',function(){
	var username = md5(E('login-account').value);
	var password = md5(E('login-password').value);
	ajax.get('http://study.163.com/webDev/login.htm?userName=' + username + '&password='+ password,function(d){
		if (d == '1') {
			setcookie({'loginSuc':'true'});
		}
		E('login-mask-pannel').style.display = 'none';
	});
});
//登录界面关闭
util.addEvent(E('login-close-control'),'click',function(){
	E('login-mask-pannel').style.display = 'none';
});



/**********************关注登录相关 END*****************************/






/*********************轮播相关 START********************/
	var SLIDER_INTERVAL = 5000;
	//获取节点
	var $ = function( selector ){
	  return [].slice.call(document.querySelectorAll(selector));
	}
	//获取slider圆点
	var cursors = $('.slider-container .slider-indicator .slider-indicator-btn');
	//为slider圆点添加点击事件
	cursors.forEach(function(cursor, index){
	  	cursor.addEventListener('click', function(){ 
		    slider.nav(index);
		});
	});


	var slider_container = document.getElementsByClassName('slider-container')[0];
	//初始化slider
	var slider = new Slider({
	  //视口容器
	  container: slider_container,
	  // 图片列表
	  images: [
	    { 'src':"./img/banner1.jpg", 'href': 'http://open.163.com'},
	    {'src':"./img/banner2.jpg", 'href': 'http://study.163.com'},
	    {'src':"./img/banner3.jpg", 'href': 'http://www.icourse163.org'}
	  ],
	});

	//绑定slider小圆点和nav来变换小圆点样式
	slider.on('nav', function( ev ){

	  var page_idx = ev.page_idx;
	  cursors.forEach(function(cursor, index){

	    if (index === page_idx) {
	      cursor.className = 'slider-indicator-btn slider-indicator-btn-active';
	    } else {
	      cursor.className = 'slider-indicator-btn';
	    }
	  })

	});

	//轮播函数
	function start_slider(time) {
		var slider_timer = setInterval(function(){
		  	// 下一页
		  	slider.next();
		},time);		
		return slider_timer;
	}
	//开始轮播
	var slider_timer = start_slider(SLIDER_INTERVAL);

	//鼠标悬停
	util.addEvent(slider_container, 'mouseover', function(ev) {
		if (slider_timer) {
			clearInterval(slider_timer);
			slider_timer = null;
		}
	});
	//鼠标离开
	util.addEvent(slider_container, 'mouseout', function(ev) {
		slider_timer = start_slider(SLIDER_INTERVAL);
	});

	
/*********************轮播相关 END********************/

/********************课程 START*************************/

var COURSE_LIST_URL = 'http://study.163.com/webDev/couresByCategory.htm';
var COURSE_HOT_URL = 'http://study.163.com/webDev/hotcouresByCategory.htm';
var type = '10';

var course_tabs = document.getElementsByClassName('tab-item');
util.addEvent(course_tabs[0],'mouseover', function() {
	type = '10';
	course_tabs[0].className = 'tab-item tab-item-active';
	course_tabs[1].className = 'tab-item';
	get_course(1,20,type, 10);
});
util.addEvent(course_tabs[1],'mouseover', function() {
	type = "20";
	course_tabs[0].className = 'tab-item';
	course_tabs[1].className = 'tab-item tab-item-active';
	get_course(1,20,type, 10);
})


//用于生成课程项
function get_course_item(course) {
	return `<div class="course-item">
	<div class="course-item-list">
		<img class="img" src = "${course.middlePhotoUrl}">
		<div class="des">
			<p class="name">${course.name}</p>
			<p class="provider">${course.provider}</p>
			<div class="learnerCount">
				<img src="img/learnercount.png" class='learner-img'>
				<span class="count">${course.learnerCount}</span>
			</div>
		<p class="price-item">￥<span class="price">${course.price}</span></p>
		</div>
		
	</div>

	<div class="course-item-detail">
		<div class="header">
			<img class="img" src = "${course.middlePhotoUrl}">
			<div class="detail">
				<p class="name">${course.name}</p>
				<div class="learnerCount-item">
					<img src="img/learnercount.png" class='learner-img'>
					<span class="learnerCount">${course.learnerCount}</span>人在学
				</div>
				<p class="provider-item">发布者：<span class="provider">${course.provider}</span></p>
				<p class="categoryName-item">分类：<span class="categoryName">${course.categoryName}</span></p>
			</div>
		</div>
		<div class="foot-describe">
			<span class="description">${course.description}</span>
		</div>	
	</div>
</div>`;
}
//用于生成课程面板跳转
function get_course_nav(page_num){
	var str = '';
	for (var idx = 0; idx < page_num; ++idx) {
		str += ('<div class="num">'+ (idx + 1) + '</div>');
	}
	return str;
}


//获取数据
function get_course(pageNo, psize, type, picSize) {
	ajax.get(COURSE_LIST_URL + '?pageNo=' + pageNo + '&psize=' + psize + '&type=' + type, function(data) {
		var course_data = JSON.parse(data);
		var content_str = "";
		course_data['list'].forEach(function(course) {
			content_str += get_course_item(course);
		});
		var coursepage_str = get_course_nav(course_data['totalPage']);
		E('course-panel').innerHTML = content_str;
		E('num-pannel').innerHTML = coursepage_str;
		//根据页数跳转
		var num_btns = document.getElementsByClassName('num');
		var b_width = document.body.offsetWidth;
		if (b_width <= 1205) {
			psize = 15;
		}else {
			psize = 20;
		}
		for (var idx = 0; idx < num_btns.length; ++ idx) {
			num_btns[idx].onclick = (function(idx) {
				return function() {
					get_course(idx + 1, psize, type, picSize);	
				}			
			})(idx);
		}
		num_btns[pageNo - 1].className = 'num active';
		//前一页
		E('course-prev').onclick = function(){
			if(pageNo == 1) return;
			get_course(pageNo - 1, psize, type, picSize);
		}
		//后一页
		E('course-next').onclick = function(){
			if(pageNo == course_data['totalPage']) return;
			get_course(pageNo + 1, psize, type, picSize);
		}

	});
}

//根据窗口大小改变获取数据个数
var b_width = document.body.offsetWidth;
if (b_width <= 1205) {
	get_course(1,15,type, 10);
}else {
	get_course(1,20,type, 10);
}




//video
util.addEvent(E('video-snap'),'click',function(){
	E('video-mask-pannel').style.display = 'block';
});
util.addEvent(E('video-close-control'),'click',function(){
	E('video-mask-pannel').style.display = 'none';
});


//hot

function get_course_hot_item(course){
	return `<div class="hot-item">
				<img class="main-pic" src="${course.smallPhotoUrl}">
				<div class="content">
					<p class="name">${course.name}</p>
					<div class="learnerCount">
						<img src="img/learnercount.png" class='learner-img'>
						<span class="count">${course.learnerCount}</span>
					</div>
				</div>
			</div>`
}

function get_course_hot() {
	ajax.get(COURSE_HOT_URL, function(data) {
		var course_hot_data = JSON.parse(data);
		var content_str = "";
		course_hot_data.forEach(function(course) {
			content_str += get_course_hot_item(course);
		});
		E('hot-content').innerHTML = content_str;

		var hot_course_container = E('hot-content');
		var hot_top_init = hot_course_container.offsetTop;
		hot_course_container.style.top = hot_top_init + "px";
		setInterval(function() {
			var first_course = hot_course_container.firstChild;
			var interval = 20;
			var top = hot_top_init;

			//我想在5000ms之后执行一次下面的1000ms的函数，让hot-content的top在1s内慢慢减少50，这样实现滚动
			var hot_timer = setInterval(function(){
				hot_course_container.style.top = top + "px";
				top -= 0.072*interval;		
				if(top <= -72) {			
					hot_course_container.removeChild(first_course);
					hot_course_container.appendChild(first_course);
					clearInterval(hot_timer);
					hot_course_container.style.top = hot_top_init + "px";
				}
			},interval);
		}, 5000);
	});
}
get_course_hot();



/********************课程 END*************************/
}
 </script>

</body>
</html>